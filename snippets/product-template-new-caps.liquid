<!-- snippets/product-template-scrub-caps.liquid -->
<!-- COMPLETE VERSION - READY TO USE -->

<script>
  if (typeof jQuery === 'undefined') {
    var script = document.createElement('script');
    script.src = "https://code.jquery.com/jquery-3.6.0.min.js";
    script.integrity = "sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=";
    script.crossOrigin = "anonymous";
    document.head.appendChild(script);
  }
</script>

<style>
/* Import Outfit font */
@import url('https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Poppins&display=swap');

@font-face {
    font-family: futuraptbold;
    font-weight: bold;
    src: url("https://cdn.shopify.com/s/files/1/0573/7250/8344/files/FuturaPTBold.otf?v=1682068317") format("opentype");
}
@font-face {
    font-family: futurapt;
    font-weight: normal;
    src: url("https://cdn.shopify.com/s/files/1/0573/7250/8344/files/FuturaPTMedium.otf?v=1682068317") format("opentype");
}

/* Loading state for price updates */
.add-to-cart-btn.loading {
  pointer-events: none;
  opacity: 0.7;
}

.price-info.loading {
  opacity: 0.5;
  transition: opacity 0.2s ease;
}

.price-loading-spinner {
  display: inline-block;
  width: 12px;
  height: 12px;
  border: 2px solid #ffffff;
  border-top-color: transparent;
  border-radius: 50%;
  animation: spin 0.6s linear infinite;
  margin-left: 8px;
  vertical-align: middle;
}
.price-info.sold-out {
  background: #cccccc !important;
  opacity: 0.6 !important;
}
@keyframes spin {
  to { transform: rotate(360deg); }
}

@media only screen and (max-width:480px){
  .slick-prev, .slick-next {
    top:50% !important;
  }
  .slick-next{
    right:-10px !important;
  }
  .product-content-right{
    position:relative;
    top:-8px;
    padding-left:35px !important;
  }
  .slick-list{
    overflow:visible !important;
  }
  .product__main-photos .slick-dots{
    left:10px !important;
  }
  .slick-slider{
    overflow:visible;
    left:-10px;
  }
  .slick-slide{
    padding-right:10px;
  }
}

.hide-preorder {
  display: none !important;
}

#preorder-text{
  display:none;
}

.photos-fixed {
  position: fixed;
}
.photos-relative {
  position: relative;
}

.loved-by-thousands {
  font-family: 'Outfit', sans-serif;
  padding-top:24px;  
}

#Reviews-8742084247810{
  display:none !important;
}

.loved-by-thousands h2 {
   font-family: 'Outfit', sans-serif !important;
font-size: 18px;
    margin-bottom: 16px;
    font-weight: 500;
}

.video-scroller {
  display: flex;
  overflow-x: auto;
  gap: 8px;
}

.video-wrapper {
  position: relative;
  border-radius: 12px;
  overflow: hidden;
  padding-bottom:0 !important;
}

.play-button {
    position: absolute;
    top: 90px;
    left: 57px;
    width: 50px;
    height: 50px;
    cursor: pointer;
    transition: transform 0.2s;
}

.video-card {
  flex:  0 0 140px;
}

.video-card video {
  width: 100%;
  border-radius: 12px;
}

.video-card p {
  font-size: 14px;
  margin-top: 8px;
}

.video-wrapper iframe, .video-wrapper video{
  position:static !important;
}

.woof-faq {
  font-family: 'Outfit', sans-serif;
  font-size: 14px;
  font-weight: 400;
}

.woof-accordion-header {
  font-family: 'Outfit', sans-serif !important;
  width: 100%;
  padding: 16px 0;
  background: none;
  border: none;
  outline: none;
  text-align: left;
  position: relative;
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  border-bottom: 1px solid #e0e0e0;
  font-weight:400 !important;
  font-size:14px;
  text-transform:capitalize;
  border-radius:0 !important;
}

.woof-accordion-header .icon {
  font-weight: 400;
  font-size: 14px;
  margin-left: 12px;
  transition: transform 0.3s ease;
}

.woof-accordion-content {
  font-family: 'Outfit', sans-serif !important;
  display: none;
  padding: 10px 0;
  border-bottom: 1px solid #e0e0e0;
}

.woof-accordion-header.mactive .icon {
  content: "-";  
}

.announcement__wrapper{
  background-color:#000 !important;
}
.announcement .announcement__text{
  font-size:12px;
  font-weight:700;
  color:#fff !important;
  font-family: 'Outfit', sans-serif;
  text-transform: uppercase;
}
.collapsible-trigger{
  font-family: 'Outfit', sans-serif !important;
}
.collapsible-content__inner.rte{
  font-family: 'Outfit', sans-serif !important;
  font-weight:400 !important
}
.collapsible-content__inner.rte p,
.collapsible-content__inner.rte strong,
.collapsible-content__inner.rte b,
.collapsible-content__inner.rte *{
  font-family: 'Outfit', sans-serif !important;
  font-weight:400 !important;
}
.site-header__logo img{
  width:116px;
}
.icon-search,
.js-modal-open-search-modal{
  display:none !important;
}
ul.slick-dots li.slick-active{
  background:#000 !important;
}

.wider{
  DISPLAY: flex;
  width: 100%;
  justify-content: flex-end;
  position: relative;
}

.trigger-pop-up.btn{
  padding: 11px 15px !important;
  background: #fff !important;
  color: #050507 !important;
  border: 1px solid #050507;
  position: absolute !important;
  font-size: 14px;
  font-weight: 400;
  text-decoration: none;
  top: -38px !important;
  line-height: 1em;
  left: inherit;
}

.scrubcaps-wrapper{
      width: 100%;
      height: 326px;
      overflow-x: scroll;
      overflow-y: hidden;
}

.scrubs-products{
    width: auto;
    height: 322px;
    flex-direction: column;
    display: flex;
    justify-content: flex-start;
    flex-wrap: wrap;
    gap: 12px;
}

.scrubs-products::-webkit-scrollbar-track {
  background: #000;
  display:none;
}

.product-options-container {
  padding: 0;
  background: white;
  border-radius: 8px;
  font-family: 'Outfit', sans-serif;
}

.rating {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 16px;
}

.stars {
  color: #000;
  font-size: 14px;
  font-weight: 500;
  font-family: 'Outfit', sans-serif;
}

.rating-text {
  font-size: 12px;
  color: #000;
  font-family: 'Outfit', sans-serif;
}

.trusted-badge {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 12px;
  color: #000;
  font-weight: 500;
  font-family: 'Outfit', sans-serif;
    background: #FDF5EF;
    padding: 4px 8px;
    border-radius: 50px;
}

.trusted-badge span:first-child {
  width: 8px;
  height: 8px;
  background: #FFF;
  border-radius: 50%;
  display: inline-block;
}

.product-title {
  font-size: 24px;
  font-weight: 600;
  font-family: 'Outfit', sans-serif;
  margin-bottom: 12px;
  color: #000;
  line-height: 1.2;
}

.product-description {
  font-size: 14px;
  color: #000;
  line-height: 1.5;
  margin-bottom: 24px;
  font-weight: 400;
  font-family: 'Outfit', sans-serif;
  letter-spacing:0.2px;
}

.option-section {
  margin-bottom: 32px;
  position: relative;
}

.option-label {
  font-size: 16px;
  font-weight: 600;
  margin-bottom: 16px;
  color: #000;
  display: flex;
  justify-content: flex-start;
  align-items: center;
  font-family: 'Outfit', sans-serif;
}

.option-label .selected-size-text{
  font-weight: 400;
  color: #000;
  padding-left: 8px;
}

.fit-guide {
    font-size: 10px;
    color: #000;
    text-decoration: underline;
    cursor: pointer;
    position: absolute;
    right: 0;
    font-weight: 500;
    top: 0;
    display: block;
    background: #FDF5EF;
    padding: 4px 8px;
    border-radius: 50px;
}

.fit-guide:hover{
  text-decoration: underline;
}

.option-buttons {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  gap: 12px;
}

.option-btn {
  padding: 4px 20px;
  border: 1px solid #e0e0e0;
  background: white;
  border-radius: 7px !important;
  height:32px !important;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  color: #000;
  flex: 1;
  font-family: 'Outfit', sans-serif;
  text-align: center;
  text-transform: capitalize !important;
}

.option-btn:hover {
  border-color: #000;
}

.option-btn.active {
  border-color: #000;
  border-width: 2px;
  background-color: #fff;
  color: #000;
}

.styles-section {
  margin-bottom: 0px;
}

.styles-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
}

.styles-title {
  font-size: 16px;
  font-weight: 600;
  color: #000;
  margin-bottom: 0;
  font-family: 'Outfit', sans-serif;
}

.add-points-text {
  color: #000;
  font-weight: 500;
  display: flex;
  align-items: center;
  gap: 6px;
  font-family: 'Outfit', sans-serif;
      font-size: 10px;
    color: #000;
    text-decoration: underline;
    cursor: pointer;
      display: block;
    background: #FDF5EF;
    padding: 4px 8px;
    border-radius: 50px;
    height:20px;
}

.add-points-text span:first-child {
  width: 6px;
  height: 6px;
  background: #000;
  border-radius: 50%;
  display: inline-block;
}

.style-categories {
  display: flex;
  gap: 8px;
  margin-bottom: 20px;
  width: 100%;
  overflow-x: auto;
  flex-wrap: nowrap;
  padding-bottom: 4px;
}

.jactive .sudo-style-count{
  color:#fff;
  background:#333;
  border-radius:50px;
  padding:2px 4px;
}

.category-btn {
  padding: 8px 16px;
  border: 1px solid #e0e0e0;
  background: white;
  border-radius: 20px;
  font-size: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
  color: #000;
  white-space: nowrap;
  font-family: 'Outfit', sans-serif;
  font-weight: 500;
  flex-shrink: 0;
  text-transform: capitalize !important;
}

.category-btn.jactive {
  background: #000;
  color: white;
  border-color: #000;
}

.styles-grid {
  display: flex;
  gap: 12px;
  overflow-x: auto;
  padding: 8px 0;
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.styles-grid::-webkit-scrollbar {
  display: none;
}

.collapsible-trigger-btn--borders{
  text-transform: capitalize !important;
    font-weight: 400;
    color: #000;
    font-size: 14px !important;
}

.style-option {
  min-width: 120px;
  width: 120px;
  height: 120px;
  border: 2px solid #e0e0e0;
  border-radius: 12px;
  background-size: cover;
  background-position: center top; 
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  overflow: visible;
  flex-shrink: 0;
  display: flex !important;
  flex-direction: column;
  justify-content: space-between;
  align-items: flex-end;
  padding: 12px;
  margin-bottom:8px;
}

.style-option:hover {
  border-color: #000;
}

.style-option.active {
  border-color: #F5BE15;
  border-width: 3px;
}

.style-option.active .viewing-badge {
  display: flex;
}

.viewing-badge {
  display: none;
  align-items: center;
  gap: 4px;
  background: #795F10;
  color: #fff;
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 10px;
  font-weight: 500;
  align-self: center;
  font-family: 'Outfit', sans-serif;
}

.viewing-icon {
  width: 8px;
  height: 8px;
  background: white;
  border-radius: 50%;
}

.style-content {
    display: flex;
    align-items: flex-end !important;
    gap: 4px;
    margin-top: 12px;    
    width: 100%;
    z-index: 9999;
}

.style-name {
  color: white;
  font-size: 10px;
  text-align: center;
  font-weight: 500;
  text-shadow: 0 1px 2px rgba(0,0,0,0.7);
  margin-bottom: 4px;
  line-height: 1.2;
  font-family: 'Outfit', sans-serif;
}

.add-to-cart-section {
  margin-top: 0;
}

.add-to-cart-btn {
  width: 100%;
  padding: 16px 20px;
  background: #000;
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  font-weight: 400;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  justify-content: space-between;
  align-items: center;
  text-transform: none;
  font-family: 'Outfit', sans-serif;
}

.add-to-cart-btn:hover {
  background: #000;
}

.add-to-cart-btn.sold-out {
  background: #999;
  cursor: not-allowed;
}

.add-to-cart-btn.sold-out:hover {
  background: #999;
}

.price-info {
  display: flex;  
  gap: 8px;
  justify-content: center;
  align-items: center;
  margin-left:4px;
  border-radius: 50px;
  background:#333;
  padding:0 12px;
}

.price-info.visible {
  display: flex;
}

.original-price {
  text-decoration: line-through;
  color: #ccc;
  font-size: 14px;
  font-family: 'Outfit', sans-serif;
}

.sudo-sale-price {
  font-size: 14px;
  font-weight: 500;
  color: white !important;
  font-family: 'Outfit', sans-serif;
}

.shipping-info {
  margin-top: 12px;
  margin-bottom: 5px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 12px;
  color: #000;
  font-family: 'Outfit', sans-serif;
}

.shipping-badge {
  display: flex;
  align-items: center;
  gap: 6px;
  font-weight: 500;
}

.shipping-badge span:first-child {
  font-size: 8px;
}

.shipping-badge svg{
  display:flex;
  width:17px;
  height:32px;
}

.hidden {
  display: none;
}

@media only screen and (max-width: 480px) {

  .product-title {
    font-size: 22px;
  }
  
  .option-buttons {
    gap: 8px;
  }
  
  .option-btn {
    padding: 12px 16px;
    font-size: 13px;
  }
  
  .styles-grid {
    gap: 8px;
  }
  
  .style-option {
    min-width: 100px;
    width: 100px;
    height: 100px;
  }
}

.flexerd{
  display:block;   
  width:100px;
  height:145px;
}

.warning-text {
  color: red;
  font-size: 14px;
  font-weight: bold;
  position: relative;
  top: -8px;
}

.product-single__meta{
  font-family: 'Outfit', sans-serif;
}

.collapsibles-wrapper--border-bottom{
  margin-top:30px;
}

.scrubcaps-wrapper{
     width: 100%;
      height: 325px;
      overflow-x: scroll;
      overflow-y: hidden;
      margin-bottom:20px;        
      padding-bottom:12px;
}

.scrubcaps-wrapper {
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.scrubcaps-wrapper::-webkit-scrollbar {
  display: none;
}

.scroll-indicator {
  width: 100%;
  height: 6px;
  background: #DBDBDB;
  border-radius: 50px;
  position: relative;
  margin-top: -25px;
  margin-bottom:40px;
}

@media only screen and (min-width:1201px){
  .oneway.product__photos.product__photos--beside {
    width: 600px;
    /* position: fixed; */
  }
}

@media only screen and (min-width:481px){
  .oneway.product__photos.product__photos--beside {    
    
  }
  
   .scrubcaps-wrapper{
    height:326px !important;
   }
  .scroll-indicator {
    margin-top: -28px;
  }
  .scrubs-products{
    width:auto;
    height:326px !important;
    flex-direction: column;
  }
}

.scroll-thumb {
  width: 60px;
  height: 6px;
  background: #000000;
  border-radius: 50px;
  position: absolute;
  transition: left 0.1s ease;
}

.video-scroller::-webkit-scrollbar,
.style-categories::-webkit-scrollbar,
.product-single__meta::-webkit-scrollbar{
  scrollbar-color: black !important;
}

@supports (scrollbar-width: thin) {
  .scrubcaps-wrapper {
    scrollbar-width: 0;
    scrollbar-color: #000000 #DBDBDB;
  }
}

.scrubs-products{
      width: auto;
      height: 325px;
      display: flex;
      justify-content: flex-start;
      flex-wrap: wrap;
      gap:12px;
}

.scrubs-products::-webkit-scrollbar-track {
  background: #000;
}

.stars {
  color: #000;
  font-size: 18px;
  letter-spacing: 0.1px;
  background: #FDF5EF;
  padding: 0 8px;
  border-radius: 50px;
  height:20px;
  line-height:18px;
}

@media only screen and (max-width:393px){
  .stars {
    font-size:15px !important;
  }
}

.sudoloox{
  font-size: 10px;
  font-weight: 400;
  position: relative;
  top: -2px;
}

.trusted-badge {
  display: flex;
  align-items: center;
  gap: 4px;
  position: relative;
  font-size: 10px;
  top: 0px;
  color: #000;
  font-weight: 400;
  height:20px;
  margin-left: 10px;
}

.product-description {
  font-size: 14px;
  color: #000;
  line-height: 1.4;
  margin-bottom: 44px;
  font-weight:400;
}

.option-section {
  margin-bottom: 44px;
  position:relative;
}

.option-label {
  font-size: 14px;
  font-weight: 600;
  margin-bottom: 12px;
  color: #000;
  display: flex;
  justify-content: flex-start;
  align-items: center;
}

.option-label .selected-size-text{
  font-weight: 400;
  padding-left:8px;
}

.fit-guide {
  font-size: 10px;
  color: #000;
  text-decoration: underline;
  cursor: pointer;
  position: absolute;
  right: 0;
  top: 0;
}

.fit-guide:hover{
  text-decoration: underline;
}

.option-buttons {
  display: flex;
  flex-wrap:wrap;
  justify-content: space-between;
  gap: 8px;
  flex-wrap: wrap;
}

.option-btn {
  padding: 4px 20px;
  border: 2px solid #e0e0e0;
  background: white;
  border-radius: 7px !important;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  color: #000;
  flex:1;
  height:32px;
}

.option-btn:hover {
  border-color: #000;
}

.option-btn.active {
  border-color: #000;
  border-width: 3px;
  background-color: #f8f9fa;
}

.styles-section {
  margin-bottom: 0px;
}

.styles-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}

.styles-title {
  font-size: 14px;
  font-weight: 600;
  color: #000;
  margin-bottom:0;
}

.add-points-text {
  font-size: 10px;
  color: #000;
  font-weight:800;
  display: flex;
  align-items: center;
  gap: 4px;
}

.style-categories {
  display: flex;
  gap: 8px;
  margin-bottom: 16px;
  width: auto;
  overflow-x: auto;
  flex-wrap: nowrap;
}

.category-btn {
  padding: 8px 16px;
  border: 1px solid #ddd;
  background: white;
  border-radius: 20px;
  font-size: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
  color: #000;
}

.category-btn.jactive {
  background: #000;
  color: white;
  border-color: #000;
}

.styles-grid {
  display: flex;
  gap: 12px;
  overflow-x: auto;
  padding: 8px 0 0;
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.styles-grid::-webkit-scrollbar {
  display: none;
}

.style-option {
  min-width: 100px;
  width: 100px;
  height: 100px;
  border: 2px solid #e0e0e0;
  border-radius: 12px;
  background-size: cover;
  background-position: center top;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  overflow: visible;
  flex-shrink: 0;
  display: flex !important;
  flex-direction: column;
  justify-content: space-between;
  align-items: flex-end;
  padding: 8px;
}

.style-option:hover {
  border-color: #000;
}

.style-option.active {
  border-color: #F5BE15;
  border-width: 3px;
}

.style-option.active .viewing-badge {
  display: flex;
}

.viewing-badge {
  display: none;
  align-items: center;
  gap: 4px;
  background:#795F10;
  color: white;
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 10px;
  font-weight: 500;
  align-self: center;
}

.viewing-icon {
  width: 8px;
  height: 8px;
  background: white;
  border-radius: 50%;
}

.style-content {
  display: flex;
  align-items:flex-end !important;
  gap: 4px;
  margin-top: auto;
  width: 100%;
}

.style-name {
  color: #000;
  font-size: 12px;
  text-align: center;
  font-weight: 600;
  text-shadow: none;
  margin-bottom: 4px;
  line-height: 1.2;
}

.add-to-cart-section {
  margin-top: 0px;
}

.add-to-cart-btn {
  width: 100%;
  padding: 16px;
  background: #000;
  color: white;
  border: none;
  border-radius: 7px !important;
  font-size: 16px;
  font-weight: 400;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  justify-content: center;
  align-items: center;
  text-transform: capitalize !important;
  gap:12px;
}

.add-to-cart-btn:hover {
  background: #000;
}

.add-to-cart-btn.sold-out {
  background: #999;
  cursor: not-allowed;
}

.add-to-cart-btn.sold-out:hover {
  background: #999;
}

.price-info {
  display: flex;  
  gap: 8px;
  align-items: center;
  margin-left: 4px;
  border-radius: 50px;
  background: #333;
  padding: 0 12px;
  width: auto;
  height: 20px;
}

.original-price {
  text-decoration: line-through;
  color: rgba(255, 255, 255, 0.6);
  font-weight: 100;
  font-size: 14px;
}

.sudo-sale-price {
  font-size: 14px;
  font-weight: 400;
}

.shipping-info {
  margin-top: 12px;
  margin-bottom:5px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 12px;
  color: #000;
  margin-bottom:20px;
}

.shipping-badge {
  display: flex;
  align-items: center;
  gap: 4px;
}

@media only screen and (max-width:480px){
    .rating{
    justify-content:space-between;
    margin-top: 12px;
  }
    .jdgm-widget.jdgm-widget{
    position:relative;
    top:-2px;
  }
  .page-content{
    padding-bottom:10px !important;
  }
  .ugstext{
    font-size:11px;
    line-height: 16px;
    display: inline-block;
  }
}

p#preorder-text {
  margin-top: 12px;
  font-size: 12px;
  margin-bottom: 0;
}

#preorder-text{
  color:red !important;
  font-weight:900;
}

.grid-product__price{
  display:flex;
}

.thumbnails-add-button.sold-out {
  pointer-events: none;
  opacity: 0.5;
  cursor: not-allowed;
}

.thumbnails-add-button.sold-out .add-text {
  color: #999 !important;
  font-weight: 600;
}

.style-option.added {
  border-color: navy !important;
  border-width: 3px !important;
  box-shadow: 0 0 0 1px navy;
}

.style-option.added.active {
  border-color: navy !important;
  box-shadow: 0 0 0 1px navy, 0 0 8px rgba(0, 0, 128, 0.3);
}

.spinner {
  display: inline-block;
  width: 16px;
  height: 16px;
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-radius: 50%;
  border-top-color: #fff;
  animation: spin 1s ease-in-out infinite;
  margin-left: 8px;
  vertical-align: middle;
  position: relative;
  top: -2px;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

@media only screen and (min-width:481px){
  .add-to-cart-btn{
    font-weight:500;
  }
  .add-points-text,
  .fit-guide,
  .trusted-badge,
  .sudoloox{
    font-size:12px !important;
    font-weight:500 !important;
  }
  .trusted-badge svg{
    position:relative;
    top:-3px;
  }
  .product-title{
    font-size:32px;
  }
  .product-description{
    font-size:16px;
    margin-bottom:20px;
  }
  .category-btn{
    font-size:13px;
  }
  .option-btn{
    font-size:15px;
  }
  .option-section{
    margin-bottom:24px;
  }
  .scrubcaps-wrapper{
    margin-bottom:0;
  }
  .scroll-indicator{
    margin-bottom:20px;
  }
  .shipping-info{
    margin-top:10px;
  }
  .uses .label{
    font-size:20px;
  }
  .uses .tag{
    font-size:16px;
    height:31px;
  }
  .woof-accordion-header{
    font-size:16px;
  }
  .loved-by-thousands h2{
    font-size:20px;
  }
  .video-card{
    flex: 0 0 235px;
  }
  .scroll-indicator {
    margin-top: -8px;
  }
  .page-width{
    max-width:1200px !important;
    padding-left:0 !important;
    padding-right:0 !important;
  }
  
  .scrubs-products{
    width: auto;
    height: auto;
    display: flex;
    justify-content: flex-start;
    align-content: flex-start;
    flex-wrap: wrap;
    gap:12px;
  }
  .play-button{
    left:50%;
    top:50%;
  }
  .grid{
    margin:0 !important;
  }
  .grid__item{
    padding-left:0 !important;
  }
  .product-single__meta{
    padding-left:30px !important;
    padding-right:30px;
  }
  .fit-guide {
    font-weight: 500;
  }
  #addToCartText{
    font-weight:500 !important;
  }
  .shipping-badge{
    font-weight:400;
  }
  .shipping-badge:nth-child(2){
    font-weight:500;
  }
}

.uses {
  font-family: 'Outfit', sans-serif;
}

.uses .label {
  font-size: 18px;
  font-weight: 500;
  margin-bottom: 12px;
}

.uses .tag-container {
  display: flex;
  gap: 12px;
  justify-content: flex-start;
  flex-wrap: nowrap;
  overflow-x: auto;
  overflow-y: hidden;
  width: auto;
  height: 34px;
  scrollbar-width: none;
  -ms-overflow-style: none;
  margin-bottom: 24px;
}

.uses .tag-container::-webkit-scrollbar {
  display: none;
}

.collapsible-trigger-btn--borders:first-child{
  border-top:none !important;
}

.uses .tag {
  padding: 3px 16px;
  font-size: 14px;
  font-weight: 400;
  border-radius: 999px;
  border: 1px solid #d1d1d1;
  background-color: #fff;
  display: block;
  color: #000;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  height: 26px;
  width: auto;
  flex: 0 0 auto;
  text-align: center;
}

.uses .tag.jactive {
  background-color: #000;
  color: #fff;
  border-color: #000;
}

.uses .tag:hover {
  opacity: 0.85;
}
</style>

<div id="sliderchecker" class="{% if section.settings.threeway %}threeway{% endif %}"></div>

<div  
  id="ProductSection-{{ section_id }}"
  class="product-section gohere"
  data-section-id="{{ section_id }}"
  data-section-type="product-template"
  {% if isModal %}
  data-subsection
  {% endif %}
  data-variant-type="{{ variant_type }}"
  {% if inventory_enable %}
  data-inventory="true"
  data-inventory-threshold="{{ inventory_threshold }}"
  {% endif %}
  {% if inventory_transfers_enable %}
  data-incoming-inventory="true"
  {% endif %}
  {% if product_image_type == 'stacked' %}
  data-images-stacked="true"
  {% endif %}
  data-video-style="{{ video_style }}"
  {% unless isModal %}
  data-enable-history-state="true"
  {% endunless %}>

  {% include 'product-template-variables' %}

  <div class="page-content">
    <div class="page-width">
      <div class="grid">
        <div class="product-image-left grid__item medium-up--one-half">
            {% include 'product-images', section_id: section_id, isModal: isModal, video_looping: video_looping, video_style: video_style %}
          
          <div class="fullimage ddoo" style="margin-top:0x; margin-bottom:0px">
            {% if product.metafields.sf_product_bundle.cts_desktop_image_1 %}
              <img src="{{ product.metafields.sf_product_bundle.cts_desktop_image_1 }}" class="desktopshow" alt="use code scrup">
            {% endif %}
            {% if product.metafields.sf_product_bundle.cts_mobile_image_1 %}
              <img src="{{ product.metafields.sf_product_bundle.cts_mobile_image_1 }}" class="mobileshow" alt="use code scrup">
            {% endif %}
          </div>
        </div>

        <div class="product-content-right grid__item medium-up--one-half {% if product_image_type == 'stacked' %} product-single__sticky{% endif %} {{ product.title | truncate: 3, "" }}" data-title="">
          <div class="product-single__meta">

<script>
window.shopCurrency = '{{ shop.currency }}';
window.displayCurrency = 'AUD';
window.currencySymbol = '$';

if (typeof Currency !== 'undefined' && Currency.currentCurrency) {
  window.displayCurrency = Currency.currentCurrency;
} else if (window.Shopify && window.Shopify.currency && window.Shopify.currency.active) {
  window.displayCurrency = window.Shopify.currency.active;
}

switch (window.displayCurrency) {
  case 'AUD':
    window.currencySymbol = '$';
    break;
  case 'CAD':
    window.currencySymbol = 'CA$';
    break;
  case 'EUR':
    window.currencySymbol = '€';
    break;
  case 'GBP':
    window.currencySymbol = '£';
    break;
  case 'HKD':
    window.currencySymbol = 'HK$';
    break;
  case 'NZD':
    window.currencySymbol = 'NZ$';
    break;
  case 'SGD':
    window.currencySymbol = 'SG$';
    break;
  case 'USD':
    window.currencySymbol = '$';
    break;
  default:
    window.currencySymbol = '$';
}

console.log('=== CURRENCY DETECTION ===');
console.log('Shop base currency:', window.shopCurrency);
console.log('Detected display currency:', window.displayCurrency);
console.log('Currency symbol:', window.currencySymbol);
console.log('=== END ===');

window.shippingThresholds = {
  'AUD': {{ settings.shipping_treshold }},
  'HKD': 753,
  'NZD': 156,
  'SGD': 126,
  'CAD': {{ settings.ca_shipping_treshold }},
  'GBP': {{ settings.gb_shipping_treshold }},
  'EUR': {{ settings.eu_shipping_treshold }},
  'USD': {{ settings.us_shipping_treshold }}
};

// MODIFIED: Single option lookup (productId-size only)
window.productVariants = {
  {% for variant in product.variants %}
    "{{ product.id }}-{{ variant.option1 | downcase | replace: ' ', '' }}": {
      id: {{ variant.id }},
      inventory: {{ variant.inventory_quantity | default: 0 }},
      available: {{ variant.available | json }},
      price: {{ variant.price }}
    }{% unless forloop.last %},{% endunless %}
  {% endfor %}
  {% paginate collections['scrub-caps'].products by 200 %}
    {% for productb in collections['scrub-caps'].products limit:200 %}
      {% if productb.available and productb.id != product.id %}
        {% for variant in productb.variants %}
          ,"{{ productb.id }}-{{ variant.option1 | downcase | replace: ' ', '' }}": {
            id: {{ variant.id }},
            inventory: {{ variant.inventory_quantity | default: 0 }},
            available: {{ variant.available | json }},
            price: {{ variant.price }}
          }
        {% endfor %}
      {% endif %}
    {% endfor %}
  {% endpaginate %}
};

function updateThumbnailAddedState(productId) {
  const styleOption = document.querySelector(`[data-id="${productId}"]`);
  if (!styleOption) return;
  
  let isAdded = false;
  Object.keys(addedProducts).forEach(key => {
    if (addedProducts[key].productId == productId) {
      isAdded = true;
    }
  });
  
  if (isAdded) {
    styleOption.classList.add('added');
  } else {
    styleOption.classList.remove('added');
  }
  
  console.log('Updated thumbnail border for product:', productId, 'Added:', isAdded);
}
</script>

<div class="product-options-container">
  <div class="rating">
    <span class="stars">★★★★★ <span class="sudoloox">4.8/5(511)</span></span>
    <div class="trusted-badge">
      <span><svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M5 10C4.31046 10 3.6634 9.86928 3.05882 9.60784C2.45425 9.34967 1.9232 8.99183 1.46569 8.53431C1.00817 8.07353 0.648693 7.54248 0.387255 6.94118C0.129085 6.3366 0 5.68954 0 5C0 4.31046 0.129085 3.6634 0.387255 3.05882C0.648693 2.45425 1.00817 1.9232 1.46569 1.46569C1.9232 1.00817 2.45425 0.650327 3.05882 0.392157C3.6634 0.130719 4.31046 0 5 0C5.68954 0 6.3366 0.130719 6.94118 0.392157C7.54575 0.650327 8.0768 1.00817 8.53431 1.46569C8.99183 1.9232 9.34967 2.45425 9.60784 3.05882C9.86928 3.6634 10 4.31046 10 5C10 5.68954 9.86928 6.3366 9.60784 6.94118C9.34967 7.54248 8.99183 8.07353 8.53431 8.53431C8.0768 8.99183 7.54575 9.34967 6.94118 9.60784C6.3366 9.86928 5.68954 10 5 10ZM2.20588 5.52941C2.20588 5.68628 2.25327 5.81373 2.34804 5.91177C2.44608 6.00654 2.5719 6.05392 2.72549 6.05392H3.94118V7.2598C3.94118 7.41994 3.98856 7.54902 4.08333 7.64706C4.18137 7.74183 4.30719 7.78922 4.46078 7.78922H5.52941C5.68628 7.78922 5.81209 7.74183 5.90686 7.64706C6.00163 7.54902 6.04902 7.41994 6.04902 7.2598V6.05392H7.26471C7.42157 6.05392 7.54739 6.00654 7.64216 5.91177C7.7402 5.81373 7.78922 5.68628 7.78922 5.52941V4.46078C7.78922 4.30719 7.7402 4.18301 7.64216 4.08824C7.54739 3.9902 7.42157 3.94118 7.26471 3.94118H6.04902V2.73529C6.04902 2.57516 6.00163 2.44771 5.90686 2.35294C5.81209 2.25817 5.68628 2.21078 5.52941 2.21078H4.46078C4.30719 2.21078 4.18137 2.25817 4.08333 2.35294C3.98856 2.44771 3.94118 2.57516 3.94118 2.73529V3.94118H2.72549C2.56863 3.94118 2.44281 3.9902 2.34804 4.08824C2.25327 4.18301 2.20588 4.30719 2.20588 4.46078V5.52941Z" fill="black"/>
</svg></span>
      <span>{{ section.settings.trust_badge_text }}</span>
    </div>
  </div>

  <h1 class="product-title" id="productTitle">{{ product.title }}</h1>
  
  <p class="product-description">
    {{ section.settings.product_description_text }}
  </p>

  <input type="hidden" class="capvarid" value=""/>
  <input type="hidden" class="selected-size" value=""/>

  <div class="option-section">
    <div class="option-label">
      Size: <span class="selected-size-text">Tie Back</span>
      <span class="fit-guide size-guide-pop">Size Guide</span>
    </div>
    <div class="option-buttons">
      <button class="option-btn active" data-size="Tie Back">Tie Back</button>
      <button class="option-btn" data-size="Ponytail">Ponytail</button>
    </div>
  </div>

  <div class="styles-section">
    <div class="styles-header">
      <h3 class="styles-title">Choose styles</h3>
      <!-- 
      <div class="add-points-text">
        
<svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M5.99694 12C5.17287 12 4.39776 11.8449 3.6716 11.5347C2.94952 11.2245 2.31311 10.7939 1.76237 10.2429C1.21163 9.69184 0.779194 9.05306 0.465069 8.32653C0.155023 7.6 0 6.82449 0 6C0 5.17551 0.155023 4.4 0.465069 3.67347C0.779194 2.94694 1.21163 2.30816 1.76237 1.75714C2.31311 1.20612 2.94952 0.77551 3.6716 0.465306C4.39776 0.155102 5.17287 0 5.99694 0C6.82101 0 7.59612 0.155102 8.32228 0.465306C9.04844 0.77551 9.68689 1.20612 10.2376 1.75714C10.7884 2.30816 11.2188 2.94694 11.5288 3.67347C11.8429 4.4 12 5.17551 12 6C12 6.82449 11.8429 7.6 11.5288 8.32653C11.2188 9.05306 10.7884 9.69184 10.2376 10.2429C9.68689 10.7939 9.04844 11.2245 8.32228 11.5347C7.59612 11.8449 6.82101 12 5.99694 12ZM4.86486 9.33673H7.39827C7.46762 9.33673 7.52269 9.31633 7.56349 9.27551C7.60428 9.23061 7.62468 9.17551 7.62468 9.1102C7.62468 9.05306 7.60428 9.00204 7.56349 8.95714C7.52269 8.91224 7.46762 8.8898 7.39827 8.8898H6.3641V5.02041C6.3641 4.94694 6.3437 4.88776 6.30291 4.84286C6.26211 4.79388 6.20296 4.76939 6.12545 4.76939H4.9077C4.84243 4.76939 4.78939 4.79184 4.7486 4.83673C4.7078 4.88163 4.6874 4.93469 4.6874 4.99592C4.6874 5.05306 4.7078 5.10408 4.7486 5.14898C4.78939 5.19388 4.84243 5.21633 4.9077 5.21633H5.90515V8.8898H4.86486C4.79959 8.8898 4.74452 8.91224 4.69964 8.95714C4.65885 9.00204 4.63845 9.05306 4.63845 9.1102C4.63845 9.17551 4.65885 9.23061 4.69964 9.27551C4.74452 9.31633 4.79959 9.33673 4.86486 9.33673ZM5.9847 3.50816C6.12749 3.50816 6.24783 3.46122 6.34574 3.36735C6.44365 3.26939 6.49261 3.15102 6.49261 3.01224C6.49261 2.86939 6.44365 2.74898 6.34574 2.65102C6.24783 2.54898 6.12749 2.49796 5.9847 2.49796C5.846 2.49796 5.72565 2.54898 5.62366 2.65102C5.52575 2.74898 5.4768 2.86939 5.4768 3.01224C5.4768 3.15102 5.52575 3.26939 5.62366 3.36735C5.72565 3.46122 5.846 3.50816 5.9847 3.50816Z" fill="black"/>
</svg>
        <span>Add 2 caps to receive 10% off</span> 
      </div>
      -->
    </div>
    <div class="styles-grid">
      <div class="scrubcaps-wrapper" id="scrollContainer">
        <div class="scrubs-products">
          {% paginate collections['scrub-caps'].products by 200 %}
            {% for productb in collections['scrub-caps'].products limit:100 %}
              {% if productb.available %}

                {% if productb.metafields.custom.design_details %}
                    {% assign overlayimage = productb.metafields.custom.design_details %}
                    {% assign overlayimagex = overlayimage | image_url: width: 500, height: 500 %}
                {% else %}
                    {% for media in productb.media %}
                    {% if media.alt contains "Closeup" %}
                    {% assign overlayimage = media %}
                    {% assign overlayimagex = overlayimage | img_url: '500x500' %}
                    {% endif %}
                    {% endfor %}
                {% endif %}
                
                {% assign style_category = '' %}
                {% for tag in productb.tags %}
                  {% if tag contains 'styles -' %}
                    {% assign style_parts = tag | split: 'styles -' %}
                    {% assign style_category = style_parts[1] | strip | downcase %}
                  {% endif %}
                {% endfor %}
                <div class="flexerd" data-tag="{{ productb.tags }}" data-id="{{ productb.id }}">
                <div class="style-option image-overlay" 
                     data-id="{{ productb.id }}" 
                     data-title="{{ productb.title }}" 
                     data-image="{{ productb.images.first | product_img_url: 'medium' }}" 
                     data-url="{{ productb.url }}" 
                     data-handle="{{ productb.handle }}" 
                     data-price="{{ productb.price | money }}" 
                     data-compare="{{ productb.compare_at_price | money }}"
                     data-category="{{ style_category }}"
                     style="background-image: url({{ overlayimagex }});">
                  
                  <div class="viewing-badge">
                    <div class="viewing-icon"></div>
                    <span>Viewing</span>
                  </div>

                </div>
                  <div class="style-content">
                    <div class="style-name">{{ productb.title | remove: "Scrub Cap" | remove: "scrub cap" }}</div>
                  </div>
                </div>

              {% endif %}
            {% endfor %}
          {% endpaginate %}
        </div>
      </div>

    </div>
    <div class="scroll-indicator">
      <div class="scroll-thumb" id="scrollThumb"></div>
    </div>
  </div>

  <style>
    .banner-version1 {
      display: none;
      margin-bottom: 20px;
      text-align: center;
     
     border-radius: 20px;
    }

    @media(min-width: 993px){
      .banner-version1 img{
        width:77%;
      }
    }
  </style>
  <div class="banner-version1">
{% if section.settings.freesetcap %}
  <img src="{{ section.settings.freesetcap | image_url: width: 800 }}" alt="{{ section.settings.freesetcap.alt | default: 'Product image' }}">
{% else %}
  <img src="https://cdn.shopify.com/s/files/1/0573/7250/8344/files/Product_Image_-_10.png?v=1760302267" alt="Default product image">
{% endif %}
  </div>

  <div class="add-to-cart-section">
  <button class="add-to-cart-btn" id="addToCartBtn">
    <span id="addToCartText">Add to Cart</span>
    <div class="price-info">
      <span class="sudo-sale-price">
        {{ product.price | money }}{% unless shop.currency == 'AUD' %} {{ shop.currency }}{% endunless %}
      </span>
    </div>
  </button>
    <p id="preorder-text">{{ section.settings.preorder_text }}</p>
    <div class="shipping-info">
   <div class="shipping-badge">    
        <span>
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="6" cy="6" r="3" fill="#1E781C"></circle>
                <circle cx="6" cy="6" r="4.5" stroke="#1E781C" stroke-opacity="0.2" stroke-width="3"></circle>
            </svg>
        </span>      
        <span id="arrival-date">Loading...</span>
    </div>
     <div class="shipping-badge" id="freeShippingBadge">
                <span>
                {% if cart.currency.iso_code == 'AUD' or cart.currency.iso_code == 'NZD' %}  
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="256" height="256" viewBox="0 0 256 256" xml:space="preserve">
<g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)">
	<circle cx="45" cy="45" r="45" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(0,0,102); fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>
	<path d="M 25.304 23.603 V 13.115 h -7.928 v 10.488 L 9.227 17.71 c -1.261 1.65 -2.407 3.391 -3.433 5.209 l 2.3 1.663 H 4.903 c -1.824 3.575 -3.193 7.42 -4.01 11.467 h 7.201 l -7.969 5.764 C 0.051 42.867 0 43.927 0 45 c 0 0.845 0.028 1.684 0.074 2.517 h 2.8 l 14.502 -10.488 v 10.488 h 7.928 V 37.029 l 14.502 10.488 h 5.318 v -3.846 L 34.586 36.05 h 10.538 V 24.583 H 34.587 l 10.538 -7.621 v -3.846 h -5.318 L 25.304 23.603 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(243,244,245); fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>
	<path d="M 38.805 67.129 l -6.007 0.522 l 0.827 5.973 l -4.154 -4.371 l -4.154 4.371 l 0.828 -5.973 l -6.007 -0.522 l 5.185 -3.077 l -3.336 -5.022 l 5.638 2.135 l 1.847 -5.74 l 1.847 5.74 l 5.638 -2.135 l -3.336 5.022 M 64.506 72.634 l -1.45 -2.182 l 2.451 0.928 l 0.801 -2.494 l 0.802 2.494 l 2.45 -0.928 l -1.45 2.182 l 2.253 1.337 l -2.61 0.227 l 0.36 2.594 l -1.805 -1.898 l -1.805 1.898 l 0.36 -2.594 l -2.61 -0.227 M 64.506 33.816 l -1.45 -2.182 l 2.451 0.928 l 0.801 -2.494 l 0.802 2.493 l 2.45 -0.927 l -1.45 2.182 l 2.253 1.337 l -2.61 0.227 l 0.36 2.594 l -1.805 -1.898 l -1.805 1.898 l 0.36 -2.594 l -2.61 -0.227 M 49.949 49.586 l -1.45 -2.181 l 2.451 0.928 l 0.802 -2.494 l 0.802 2.494 l 2.451 -0.928 l -1.45 2.181 l 2.253 1.338 l -2.61 0.227 l 0.36 2.594 l -1.805 -1.898 l -1.805 1.898 l 0.36 -2.594 l -2.61 -0.227 M 77.449 45.704 l -1.453 -2.182 l 2.452 0.928 l 0.796 -2.494 l 0.806 2.494 l 2.446 -0.928 l -1.446 2.182 l 2.252 1.337 l -2.61 0.227 l 0.359 2.594 l -1.805 -1.898 l -1.805 1.898 l 0.359 -2.594 l -2.606 -0.227 M 72.131 57.141 l -1.427 0.884 l 0.401 -1.629 l -1.282 -1.082 l 1.674 -0.123 l 0.634 -1.554 l 0.634 1.554 l 1.674 0.123 l -1.282 1.082 l 0.401 1.629" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(243,244,245); fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>
	<path d="M 23.719 13.115 h -4.757 v 13.761 H 3.811 c -0.973 2.208 -1.784 4.503 -2.395 6.88 h 17.546 v 13.761 h 4.757 V 33.756 h 21.406 v -6.88 H 23.719 V 13.115 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(204,0,0); fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>
	<path d="M 13.412 36.05 L 0.019 45.736 c 0.01 0.596 0.023 1.191 0.055 1.781 h 1.028 L 16.958 36.05 H 13.412 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(204,0,0); fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>
	<polygon points="29.27,36.05 45.13,47.52 45.13,47.52 45.13,44.95 32.81,36.05 " style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(204,0,0); fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>
	<polygon points="45.13,13.12 41.58,13.12 25.72,24.58 29.27,24.58 " style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(204,0,0); fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>
	<path d="M 7.422 20.25 c -0.382 0.579 -0.752 1.166 -1.107 1.763 l 3.552 2.569 h 3.545 L 7.422 20.25 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(204,0,0); fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>
</g>
</svg>
                {% endif %}
</span>
        <span id="shippingThresholdText">Loading...</span>
      </div>
    </div>
  </div>
</div>

  <div class="uses">
    <div class="label">What are you using this for?</div>
    <div class="tag-container">
      <div class="tag">Work</div>
      <div class="tag">Surgery</div>
      <div class="tag">Style</div>
      <div class="tag">Gift</div>
    </div>
  </div>

<script>
  
function formatPrice(value) {
  const currencySymbol = window.currencySymbol || '$';
  
  // Just return symbol + price, no currency code
  return currencySymbol + value.toFixed(2);
}

function updateCurrentProductStatus(productId = null) {  
  const selectedSize = document.querySelector('.selected-size')?.value || 'Tie Back';
  const selectedProductId = productId || document.querySelector('.capvarid')?.value || '{{ product.id }}';
  const variantKey = `${selectedProductId}-${selectedSize.toLowerCase().replace(' ', '')}`;
  
  console.log('=== UPDATE CURRENT PRODUCT STATUS ===');
  console.log('Product ID:', selectedProductId);
  console.log('Size:', selectedSize);
  console.log('Variant Key:', variantKey);
  
  const variant = window.productVariants[variantKey];
  const addToCartBtn = document.getElementById('addToCartBtn');
  const addToCartText = document.getElementById('addToCartText');
  const priceInfoElement = document.querySelector('.price-info'); // ✅ ADD THIS LINE
  
  if (!variant) {
    console.log('Variant not found - SOLD OUT');
    addToCartBtn.classList.add('sold-out');
    addToCartBtn.disabled = true;
    addToCartText.textContent = 'Sold Out';
    // ✅ ADD THESE 3 LINES
    if (priceInfoElement) {
      priceInfoElement.classList.add('sold-out');
    }
    return;
  }
  
  if (variant.available && variant.inventory > 0) {
    console.log('Status: IN STOCK');
    addToCartBtn.classList.remove('sold-out');
    addToCartBtn.disabled = false;
    addToCartText.textContent = 'Add to Cart';
    // ✅ ADD THESE 3 LINES
    if (priceInfoElement) {
      priceInfoElement.classList.remove('sold-out');
    }
  } else if (variant.available && variant.inventory <= 0) {
    console.log('Status: PREORDER');
    addToCartBtn.classList.remove('sold-out');
    addToCartBtn.disabled = false;
    addToCartText.textContent = 'Pre-Order';
    // ✅ ADD THESE 3 LINES
    if (priceInfoElement) {
      priceInfoElement.classList.remove('sold-out');
    }
  } else {
    console.log('Status: SOLD OUT');
    addToCartBtn.classList.add('sold-out');
    addToCartBtn.disabled = true;
    addToCartText.textContent = 'Sold Out';
    // ✅ ADD THESE 3 LINES
    if (priceInfoElement) {
      priceInfoElement.classList.add('sold-out');
    }
  }
  
  console.log('=== END UPDATE ===');
}

function updatePreorderText() {
  const preorderTextElement = document.getElementById('preorder-text');
  if (!preorderTextElement) return;
  
  const selectedSize = document.querySelector('.selected-size')?.value || 'Tie Back';
  const selectedProductId = document.querySelector('.capvarid').value || '{{ product.id }}';
  const variantKey = `${selectedProductId}-${selectedSize.toLowerCase().replace(' ', '')}`;
  const currentVariant = window.productVariants[variantKey];
  
  if (!currentVariant || !currentVariant.available) {
    preorderTextElement.style.display = 'none';
    return;
  }
  
  if (hasPreorderItems()) {
    preorderTextElement.style.display = 'block';
  } else {
    preorderTextElement.style.display = 'none';
  }
}

let addedProducts = {};

document.addEventListener('DOMContentLoaded', function() {
  function updatePriceInfo(styleOption) {
    const priceData = styleOption.dataset.price;
    const compareData = styleOption.dataset.compare;
    
    const originalPriceElement = document.querySelector('.original-price');
    const sudoSalePriceElement = document.querySelector('.sudo-sale-price');
    
    if (sudoSalePriceElement && priceData) {
      const priceValue = extractPriceValue(priceData);
      sudoSalePriceElement.textContent = formatPrice(priceValue);
    }
    
    if (originalPriceElement && compareData) {
     const comparePriceValue = extractPriceValue(compareData);
      originalPriceElement.textContent = formatPrice(comparePriceValue);
    }
  }

  const activeStyleOption = document.querySelector('.style-option.jactive');
  if (activeStyleOption) {
    updatePriceInfo(activeStyleOption);
  }

  const sizeButtons = document.querySelectorAll('.option-btn[data-size]');
  const selectedSizeInput = document.querySelector('.selected-size');
  const selectedSizeText = document.querySelector('.selected-size-text');
  
  const addToCartBtn = document.getElementById('addToCartBtn');
  const addToCartText = document.getElementById('addToCartText');
  const productTitle = document.getElementById('productTitle');

  // MODIFIED: getVariantId for single option
  function getVariantId(productId, size) {
    const variantKey = `${productId}-${size.toLowerCase().replace(' ', '')}`;
    return window.productVariants[variantKey]?.id || null;
  }

  function updateAddPointsText() {
    const addPointsSpan = document.querySelector('.add-points-text span');
    if (!addPointsSpan) return;
    
    let totalMemoryQuantity = 0;
    Object.values(addedProducts).forEach(product => {
        totalMemoryQuantity += product.quantity;
    });
  }

  function clearAllThumbnailStates() {
    document.querySelectorAll('.style-option').forEach(styleOption => {
      styleOption.classList.remove('added');
    });
  }

  function addProductToMemory(productId) {
    const selectedSize = selectedSizeInput.value || 'Tie Back';
    const variantId = getVariantId(productId, selectedSize);
    
    if (!variantId) {
      alert('Variant not available for this combination');
      return;
    }
    
    const productKey = `${productId}-${selectedSize}`;
    
    if (addedProducts[productKey]) {
      addedProducts[productKey].quantity += 1;
    } else {
      addedProducts[productKey] = {
        productId: productId,
        variantId: variantId,
        size: selectedSize,
        quantity: 1
      };
    }
  }

 // Size selection - MODIFIED with price update
  sizeButtons.forEach(button => {
    button.addEventListener('click', function() {
      // Show loading state
      const priceInfo = document.querySelector('.price-info');
      if (priceInfo) {
        priceInfo.classList.add('loading');
      }
      
      sizeButtons.forEach(btn => btn.classList.remove('active'));
      this.classList.add('active');
      selectedSizeInput.value = this.dataset.size;
      selectedSizeText.textContent = this.textContent; 
      
      // Update everything including prices
      updateCurrentProductStatus();      
      updatePreorderText();
      updateArrivalDate();
      updateAllThumbnailAvailability();
      updatePriceBasedOnSize(); // NEW - Updates price when size changes
          
      // Remove loading state after updates
      setTimeout(() => {
        if (priceInfo) {
          priceInfo.classList.remove('loading');
        }
      }, 200);
    });
  });

  // Style category filtering
  const categoryButtons = document.querySelectorAll('.category-btn');
  const styleOptions = document.querySelectorAll('.style-option');
  const tagger = document.querySelectorAll('.tag');

  tagger.forEach(button => {
    button.addEventListener('click', function() {
      tagger.forEach(btn => btn.classList.remove('jactive'));
      this.classList.add('jactive');
    });
  });

  if (tagger.length > 0) {
    const firstStylex = tagger[0];
    firstStylex.classList.add('jactive');
  }

  if (categoryButtons.length > 0) {
    const firstStyley = categoryButtons[0];
    firstStyley.classList.add('jactive');
  }

  const categoryBtns = document.querySelectorAll('.category-btn');
  categoryBtns.forEach(btn => {
    btn.addEventListener('click', function() {
      categoryBtns.forEach(button => button.classList.remove('jactive'));
      this.classList.add('jactive');
      
      const selectedCategory = this.dataset.category.toLowerCase();
      
      document.querySelectorAll('.flexerd').forEach(flexerdElement => {
        const flexerdTag = (flexerdElement.dataset.tag || '').toLowerCase();
        
        if (selectedCategory === 'all' || flexerdTag.includes(selectedCategory)) {
          flexerdElement.style.display = 'block';
        } else {
          flexerdElement.style.setProperty('display', 'none', 'important');
        }
      });
    });
  });

  // Style selection
  styleOptions.forEach(option => {
    option.addEventListener('click', function(e) {      
      styleOptions.forEach(opt => opt.classList.remove('active'));
      this.classList.add('active');
      
      productTitle.textContent = this.dataset.title;
      document.querySelector('.capvarid').value = this.dataset.id;
      
      const priceData = this.dataset.price;
      const compareData = this.dataset.compare;
      const originalPriceElement = document.querySelector('.original-price');
      const sudoSalePriceElement = document.querySelector('.sudo-sale-price');
      
      updateCurrentProductStatus();    
      updatePreorderText();
      updateArrivalDate();
      updatePriceBasedOnSize();
      
    });
  });

  // Add to Cart - MODIFIED for single option
  addToCartBtn.addEventListener('click', function() {
    if (this.disabled) {
      return;
    }

    const originalText = addToCartText.textContent;
    addToCartText.innerHTML = 'Adding... <span class="spinner"></span>';
    addToCartBtn.disabled = true;
    addToCartBtn.style.opacity = '0.7';
    addToCartBtn.style.cursor = 'not-allowed';

    const cartItems = [];
    const memoryProductCount = Object.keys(addedProducts).length;
    
    if (memoryProductCount === 0) {
      const selectedSize = selectedSizeInput.value || 'Tie Back';
      const selectedProductId = document.querySelector('.capvarid').value || '{{ product.id }}';
      const variantKey = `${selectedProductId}-${selectedSize.toLowerCase().replace(' ', '')}`;
      const mainVariant = window.productVariants[variantKey];
      
      if (mainVariant && mainVariant.available) {
        cartItems.push({
          id: mainVariant.id,
          quantity: 1,
          properties: {
            'Size': selectedSize
          }
        });
      }
    } else {
      Object.values(addedProducts).forEach(product => {
        cartItems.push({
          id: product.variantId,
          quantity: product.quantity,
          properties: {
            'Size': product.size
          }
        });
      });
    }
    
    if (cartItems.length === 0) {
      addToCartText.textContent = originalText;
      addToCartBtn.disabled = false;
      addToCartBtn.style.opacity = '1';
      addToCartBtn.style.cursor = 'pointer';
      alert('No items available to add to cart.');
      return;
    }
    
    const updateCartCount = async () => {
      let totalCount = 0;
    
      try {
        const response = await fetch('/cart.js');
        const cart = await response.json();
        
        cart.items.forEach(item => {
          if (item.product_type === 'Scrub Caps') {
            totalCount += item.quantity;
          }
        });
        
        updateAddPointsText(totalCount);
      } catch (error) {
        if (typeof window.cart !== 'undefined' && window.cart.items) {
          window.cart.items.forEach(item => {
            if (item.product_type === 'Scrub Caps') {
              totalCount += item.quantity;
            }
          });
          updateAddPointsText(totalCount);
        }
      }
    };
    
    {% comment %}
    const updateAddPointsText = (totalCount) => {
      const addPointsSpan = document.querySelector('.add-points-text span');
      if (!addPointsSpan) return;
      
      if (totalCount === 0) {
        addPointsSpan.textContent = 'Add 2 caps to receive 10% off';
      } else if (totalCount === 1) {
        addPointsSpan.textContent = 'Add 1 more cap to receive 10% off';
      } else if (totalCount === 2) {
        addPointsSpan.textContent = 'Add 2 more caps for 25% off + FREE Shipping';
      } else if (totalCount === 3) {
        addPointsSpan.textContent = 'Add 1 more cap to receive 25% off + FREE Shipping';
      } else if (totalCount === 4) {
        addPointsSpan.textContent = 'Add 2 more caps for 30% off';
      } else if (totalCount === 5) {
        addPointsSpan.textContent = 'Add 1 more cap to receive 30% off';
      } else if (totalCount >= 6) {
        addPointsSpan.textContent = 'Congratulations! You got 30% off + FREE Shipping';
      }
    };
    {% endcomment %}
    const addItemsSequentially = async (items) => {
      try {
        for (const item of items) {
          const response = await fetch('/cart/add.js', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(item)
          });
          
          if (!response.ok) {
            throw new Error(`Failed to add item: ${response.statusText}`);
          }
          
          await response.json();
        }
        
        await updateCartCount();
        
        addToCartText.textContent = originalText;
        addToCartBtn.disabled = false;
        addToCartBtn.style.opacity = '1';
        addToCartBtn.style.cursor = 'pointer';
        
        addedProducts = {};
        clearAllThumbnailStates();
        
        console.log(`Successfully added ${cartItems.length} items to cart`);
        
        if (typeof cart_open === 'function') {
          cart_open();
        }
        
      } catch (error) {
        console.error('Error adding item to cart:', error);
        
        addToCartText.textContent = originalText;
        addToCartBtn.disabled = false;
        addToCartBtn.style.opacity = '1';
        addToCartBtn.style.cursor = 'pointer';
        
        alert(`Error adding item to cart: ${error.message}`);
      }
    };
    
    addItemsSequentially(cartItems);
  });

  selectedSizeInput.value = 'Tie Back';
  updateCurrentProductStatus();
  updatePreorderText();
  updateATCPrices();
});

function extractPriceValue(priceString) {
  if (!priceString) return 0;
  let cleanString = priceString.replace(/[^0-9.,]/g, '');
  const lastCommaIndex = cleanString.lastIndexOf(',');
  const lastDotIndex = cleanString.lastIndexOf('.');
  
  if (lastCommaIndex !== -1 && lastDotIndex !== -1) {
    if (lastDotIndex > lastCommaIndex) {
      cleanString = cleanString.replace(/,/g, '');
    } else {
      cleanString = cleanString.replace(/\./g, '').replace(',', '.');
    }
  } else if (lastCommaIndex !== -1) {
    const parts = cleanString.split(',');
    if (parts.length === 2 && parts[1].length <= 2) {
      cleanString = cleanString.replace(',', '.');
    } else {
      cleanString = cleanString.replace(/,/g, '');
    }
  }
  
  const numericValue = parseFloat(cleanString);
  return isNaN(numericValue) ? 0 : numericValue;
}

function updatePriceBasedOnSize() {
  const selectedSize = document.querySelector('.selected-size')?.value || 'Tie Back';
  const selectedProductId = document.querySelector('.capvarid')?.value || '{{ product.id }}';
  const variantKey = `${selectedProductId}-${selectedSize.toLowerCase().replace(' ', '')}`;
  
  const variant = window.productVariants[variantKey];
  
  if (!variant) {
    console.log('Variant not found for price update');
    return;
  }
  
  const sudoSalePriceElement = document.querySelector('.sudo-sale-price');
  const priceInfoContainer = document.querySelector('.price-info');
  
  // Convert cents to dollars
  const priceInDollars = variant.price / 100;

  console.log('=== PRICE UPDATE ON SIZE CHANGE ===');
  console.log('Selected Size:', selectedSize);
  console.log('Variant Price:', priceInDollars);
  
  // Update price text
  if (sudoSalePriceElement) {    
    sudoSalePriceElement.textContent = formatPrice(priceInDollars);
  }
  
  // CRITICAL: Show the price by adding visible class
  if (priceInfoContainer) {
    priceInfoContainer.classList.add('visible');
  }
  
  console.log('=== END PRICE UPDATE ===');
  
}

function getCurrentProductPrice() {
  // Get price from variant data based on selected size
  const selectedSize = document.querySelector('.selected-size')?.value || 'Tie Back';
  const selectedProductId = document.querySelector('.capvarid')?.value || '{{ product.id }}';
  const variantKey = `${selectedProductId}-${selectedSize.toLowerCase().replace(' ', '')}`;
  
  const variant = window.productVariants[variantKey];
  if (variant && variant.price) {
    return variant.price / 100; // Convert cents to dollars
  }
  
  // Fallback to old method
  const activeStyleOption = document.querySelector('.style-option.active');
  if (activeStyleOption && activeStyleOption.dataset.price) {
    return extractPriceValue(activeStyleOption.dataset.price);
  }
  
  const currentPriceElement = document.querySelector('.sudo-sale-price');
  if (currentPriceElement && currentPriceElement.textContent) {
    return extractPriceValue(currentPriceElement.textContent);
  }
  
  const firstStyleOption = document.querySelector('.style-option');
  if (firstStyleOption && firstStyleOption.dataset.price) {
    return extractPriceValue(firstStyleOption.dataset.price);
  }
  
  return 0;
}

function getProductPrice(productId) {
  // Get price from variant data with selected size
  const selectedSize = document.querySelector('.selected-size')?.value || 'Tie Back';
  const variantKey = `${productId}-${selectedSize.toLowerCase().replace(' ', '')}`;
  
  const variant = window.productVariants[variantKey];
  if (variant && variant.price) {
    return variant.price / 100; // Convert cents to dollars
  }
  
  // Fallback to old method
  const styleOption = document.querySelector(`[data-id="${productId}"]`);
  if (styleOption && styleOption.dataset.price) {
    return extractPriceValue(styleOption.dataset.price);
  }
  return 0;
}

function getDiscountPercentage(memoryProductCount) {
  if (memoryProductCount >= 6) return 30;
  if (memoryProductCount >= 4) return 25;
  if (memoryProductCount >= 2) return 10;
  return 0;
}

function updateATCPrices() {
  let totalMemoryQuantity = 0;
  Object.values(addedProducts).forEach(product => {
    totalMemoryQuantity += product.quantity;
  });
  
  let totalOriginalPrice = 0;
  
  if (totalMemoryQuantity === 0) {
    totalOriginalPrice = getCurrentProductPrice();
  } else {
    Object.values(addedProducts).forEach(product => {
      const productPrice = getProductPrice(product.productId);
      totalOriginalPrice += (productPrice * product.quantity);
    });
  }
  
  const discountPercentage = getDiscountPercentage(totalMemoryQuantity);
  const discountAmount = (totalOriginalPrice * discountPercentage) / 100;
  const finalPrice = totalOriginalPrice - discountAmount;
  
  const originalPriceElement = document.querySelector('.original-price');
  const sudoSalePriceElement = document.querySelector('.sudo-sale-price');
  
  let formatReference = (window.currencySymbol || '$') + '35.92';
  if (sudoSalePriceElement && sudoSalePriceElement.textContent) {
    formatReference = sudoSalePriceElement.textContent;
  }
  
  if (originalPriceElement) {
    originalPriceElement.textContent = formatPrice(totalOriginalPrice);
    if (discountPercentage > 0) {
      originalPriceElement.style.display = '';
    } else {
      originalPriceElement.style.display = 'none';
    }
  }
  
  if (sudoSalePriceElement) {
    if (discountPercentage > 0) {
      sudoSalePriceElement.textContent = formatPrice(finalPrice);
    } else {
      sudoSalePriceElement.textContent = formatPrice(totalOriginalPrice);
    }
  }
  
  const priceInfoContainer = document.querySelector('.price-info');
  if (priceInfoContainer) {
    priceInfoContainer.classList.add('visible');
  }
}

// MODIFIED: isProductPreorder for single option
function isProductPreorder(productId) {
  const selectedSizeInput = document.querySelector('.selected-size');
  const selectedSize = (selectedSizeInput ? selectedSizeInput.value : '') || 'Tie Back';
  const variantKey = `${productId}-${selectedSize.toLowerCase().replace(' ', '')}`;
  
  const variant = window.productVariants[variantKey];
  
  if (!variant) return false;
  return variant.available && variant.inventory <= 0;
}

function hasPreorderItems() {
  const selectedSize = document.querySelector('.selected-size')?.value || 'Tie Back';
  const selectedProductId = document.querySelector('.capvarid').value || '{{ product.id }}';
  const variantKey = `${selectedProductId}-${selectedSize.toLowerCase().replace(' ', '')}`;
  const currentVariant = window.productVariants[variantKey];
  
  const currentIsPreorder = currentVariant && currentVariant.available && currentVariant.inventory <= 0;
  
  let memoryHasPreorder = false;
  for (const productKey in addedProducts) {
    const product = addedProducts[productKey];
    const productVariantKey = `${product.productId}-${product.size.toLowerCase().replace(' ', '')}`;
    const variant = window.productVariants[productVariantKey];
    
    const isPreorder = variant && variant.available && variant.inventory <= 0;
    if (isPreorder) {
      memoryHasPreorder = true;
    }
  }
  
  return currentIsPreorder || memoryHasPreorder;
}

function updateATCButtonText() {
  const addToCartText = document.getElementById('addToCartText');
  if (!addToCartText) return;
  
  if (hasPreorderItems()) {
    addToCartText.textContent = 'Pre-Order';
  } else {
    addToCartText.textContent = 'Add to Cart';
  }

  updatePreorderText();
}

// MODIFIED: isProductVariantAvailable for single option
function isProductVariantAvailable(productId, size) {
  const variantKey = `${productId}-${size.toLowerCase().replace(' ', '')}`;
  const variant = window.productVariants[variantKey];
  
  if (!variant) {
    return false;
  }
  
  return variant.available;
}

function updateAllThumbnailAvailability() {
  const selectedSizeInput = document.querySelector('.selected-size');
  const selectedSize = (selectedSizeInput ? selectedSizeInput.value : '') || 'Tie Back';
  
  document.querySelectorAll('.style-option').forEach(styleOption => {
    const productId = styleOption.dataset.id;
    const isAvailable = isProductVariantAvailable(productId, selectedSize);
  });
}

const scrollContainer = document.getElementById('scrollContainer');
const scrollThumb = document.getElementById('scrollThumb');
const scrollIndicator = document.querySelector('.scroll-indicator');

let isDragging = false;
let startX;
let startScrollLeft;
let thumbStartLeft;

function updateScrollIndicator() {
  const scrollLeft = scrollContainer.scrollLeft;
  const maxScroll = scrollContainer.scrollWidth - scrollContainer.clientWidth;
  const maxThumbPosition = scrollIndicator.offsetWidth - 60;
  const thumbPosition = maxScroll > 0 ? (scrollLeft / maxScroll) * maxThumbPosition : 0;
  
  scrollThumb.style.left = thumbPosition + 'px';
}

function startDrag(e) {
  isDragging = true;
  scrollThumb.style.cursor = 'grabbing';
  
  const rect = scrollIndicator.getBoundingClientRect();
  startX = (e.type === 'mousedown' ? e.clientX : e.touches[0].clientX) - rect.left;
  startScrollLeft = scrollContainer.scrollLeft;
  thumbStartLeft = parseInt(scrollThumb.style.left) || 0;
  
  e.preventDefault();
  document.body.style.userSelect = 'none';
  
  if (e.type === 'mousedown') {
    document.addEventListener('mousemove', drag);
    document.addEventListener('mouseup', stopDrag);
  } else {
    document.addEventListener('touchmove', drag, { passive: false });
    document.addEventListener('touchend', stopDrag);
  }
}

function drag(e) {
  if (!isDragging) return;
  
  e.preventDefault();
  
  const rect = scrollIndicator.getBoundingClientRect();
  const currentX = (e.type === 'mousemove' ? e.clientX : e.touches[0].clientX) - rect.left;
  const deltaX = currentX - startX;
  
  const maxThumbPosition = scrollIndicator.offsetWidth - 60;
  let newThumbPosition = thumbStartLeft + deltaX;
  
  newThumbPosition = Math.max(0, Math.min(newThumbPosition, maxThumbPosition));
  
  const maxScroll = scrollContainer.scrollWidth - scrollContainer.clientWidth;
  const scrollRatio = maxThumbPosition > 0 ? newThumbPosition / maxThumbPosition : 0;
  const newScrollLeft = scrollRatio * maxScroll;
  
  scrollContainer.scrollLeft = newScrollLeft;
}

function stopDrag() {
  isDragging = false;
  scrollThumb.style.cursor = 'grab';
  document.body.style.userSelect = '';
  
  document.removeEventListener('mousemove', drag);
  document.removeEventListener('mouseup', stopDrag);
  document.removeEventListener('touchmove', drag);
  document.removeEventListener('touchend', stopDrag);
}

function handleIndicatorClick(e) {
  if (e.target === scrollThumb) return;
  
  const rect = scrollIndicator.getBoundingClientRect();
  const clickX = e.clientX - rect.left;
  const maxThumbPosition = scrollIndicator.offsetWidth - 60;
  const maxScroll = scrollContainer.scrollWidth - scrollContainer.clientWidth;
  
  const targetThumbPos = Math.max(0, Math.min(clickX - 30, maxThumbPosition));
  const scrollRatio = maxThumbPosition > 0 ? targetThumbPos / maxThumbPosition : 0;
  const targetScrollLeft = scrollRatio * maxScroll;
  
  scrollContainer.scrollTo({
    left: targetScrollLeft,
    behavior: 'smooth'
  });
}

scrollContainer.addEventListener('scroll', updateScrollIndicator);
window.addEventListener('resize', updateScrollIndicator);

scrollThumb.addEventListener('mousedown', startDrag);
scrollThumb.addEventListener('touchstart', startDrag, { passive: false });

scrollIndicator.addEventListener('click', handleIndicatorClick);

updateScrollIndicator();

scrollThumb.style.cursor = 'grab';

var preorderdate = '{{ section.settings.sockpreorderdate }}';

function updateArrivalDate() {
  const arrivalElement = document.getElementById('arrival-date');
  const preorderText = document.getElementById('preorder-text');
  if (!arrivalElement) return;
  
  if (hasPreorderItems()) {
    arrivalElement.textContent = 'Expected dispatch by ' + preorderdate;
  } else {    
    preorderText.style.display = 'none';
    const today = new Date();
    const arrivalDate = new Date(today);
    arrivalDate.setDate(today.getDate() + 5);
    
    const options = { 
      month: 'short', 
      day: 'numeric' 
    };
    
    const formattedDate = arrivalDate.toLocaleDateString('en-US', options);
    arrivalElement.textContent = `Arrives by ${formattedDate}`;
  }
}

updateArrivalDate();

document.addEventListener("DOMContentLoaded", function () {
  const headers = document.querySelectorAll(".woof-accordion-header");

  headers.forEach(header => {
    header.addEventListener("click", () => {
      const isActive = header.classList.contains("mactive");
      headers.forEach(h => {
        h.classList.remove("mactive");
        h.querySelector(".icon").innerHTML = '<svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 4.24468V5.52128H5.74468V9.94681H4.25532V5.52128H0V4.24468H4.25532V0.0531921H5.74468V4.24468H10Z" fill="black"/></svg>';
        h.nextElementSibling.style.display = "none";
      });

      if (!isActive) {
        header.classList.add("mactive");
        header.querySelector(".icon").innerHTML = '<svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 4.24468H10V5.52128H0V4.24468Z" fill="black"/></svg>';
        header.nextElementSibling.style.display = "block";
      }
    });
  });
  
  updateAllThumbnailAvailability();
});

function updateShippingBadge() {
  const shippingBadge = document.getElementById('freeShippingBadge');
  const shippingText = document.getElementById('shippingThresholdText');
  
  if (!shippingBadge || !shippingText) return;
  
  const currency = window.displayCurrency || 'AUD';
  const threshold = window.shippingThresholds[currency] || 145;
  const symbol = window.currencySymbol || '$';
  
  if (currency === 'AUD') {
    shippingText.textContent = `FREE Shipping over ${symbol}${threshold}`;
  } else {
    shippingText.textContent = `FREE Shipping over ${symbol}${threshold} ${currency}`;
  }
}

document.addEventListener('DOMContentLoaded', updateShippingBadge);
updateShippingBadge();

function countScrubCaps() {
  let totalCount = 0;
  
  fetch('/cart.js')
    .then(response => response.json())
    .then(cart => {
      cart.items.forEach(item => {
        if (item.product_type === 'Scrub Caps') {
          totalCount += item.quantity;
        }
      });      
      const addPointsSpan = document.querySelector('.add-points-text span');
      if (!addPointsSpan) return;
      /*
      if (totalCount === 0) {
          addPointsSpan.textContent = 'Add 2 caps to receive 10% off';
      } else if (totalCount === 1) {
          addPointsSpan.textContent = 'Add 1 more cap to receive 10% off';
      } else if (totalCount === 2) {
          addPointsSpan.textContent = 'Add 2 more caps for 25% off + FREE Shipping';
      } else if (totalCount === 3) {
          addPointsSpan.textContent = 'Add 1 more cap to receive 25% off + FREE Shipping';
      } else if (totalCount === 4) {
          addPointsSpan.textContent = 'Add 2 more caps for 30% off';
      } else if (totalCount === 5) {
          addPointsSpan.textContent = 'Add 1 more cap to receive 30% off';
      } else if (totalCount >= 6) {
          addPointsSpan.textContent = 'Congratulations! You got 30% off + FREE Shipping';
      }
      */
    })
    .catch(() => {
      if (typeof window.cart !== 'undefined' && window.cart.items) {
        window.cart.items.forEach(item => {
          if (item.product_type === 'Scrub Caps') {
            totalCount += item.quantity;
          }
        });
        const addPointsSpan = document.querySelector('.add-points-text span');
        if (!addPointsSpan) return;
        
        if (totalCount === 0) {
            addPointsSpan.textContent = 'Add 2 caps to receive 10% off';
        } else if (totalCount === 1) {
            addPointsSpan.textContent = 'Add 1 more cap to receive 10% off';
        } else if (totalCount === 2) {
            addPointsSpan.textContent = 'Add 2 more caps for 25% off + FREE Shipping';
        } else if (totalCount === 3) {
            addPointsSpan.textContent = 'Add 1 more cap to receive 25% off + FREE Shipping';
        } else if (totalCount === 4) {
            addPointsSpan.textContent = 'Add 2 more caps for 30% off';
        } else if (totalCount === 5) {
            addPointsSpan.textContent = 'Add 1 more cap to receive 30% off';
        } else if (totalCount >= 6) {
            addPointsSpan.textContent = 'Congratulations! You got 30% off + FREE Shipping';
        }       
      }
    });
}

document.addEventListener('DOMContentLoaded', countScrubCaps);
document.addEventListener('cart:updated', countScrubCaps);
document.addEventListener('cart:refresh', countScrubCaps);

document.addEventListener("scroll", function () {
    if (window.innerWidth < 1201) return;
  const photos = document.querySelector(".oneway.product__photos.product__photos--beside");
  const lovedSection = document.querySelector(".add-to-cart-btn");

  if (!photos || !lovedSection) return;

  const lovedTop = lovedSection.getBoundingClientRect().top;

  if (lovedTop <= 0) {
    photos.style.position = "relative";
  } else {
    photos.style.position = "relative";
  }

});

const scrubcaps = document.querySelector('.scrubcaps-wrapper');

scrubcaps.addEventListener('wheel', function (e) {
  if (e.deltaY !== 0) {
    e.preventDefault();
    scrubcaps.scrollLeft += e.deltaY;
  }
}, { passive: false });

document.addEventListener('DOMContentLoaded', function() {
  const currentProductId = {{ product.id }};
  const currentProductElement = document.querySelector('.flexerd[data-id="' + currentProductId + '"]');
  
  if (currentProductElement) {
    // Remove active class from all style-option elements
    document.querySelectorAll('.flexerd .style-option').forEach(el => el.classList.remove('active'));
    
    // Add active class to the current product's style-option child
    const styleOption = currentProductElement.querySelector('.style-option');
    if (styleOption) {
      styleOption.classList.add('active');
    }
    
    // Scroll to the active thumbnail if needed
    currentProductElement.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
  }
});

const tagContent = {
  'Work': {
    title: 'Do they work for long shifts?',
    content: '<p><span><strong>Yes! These are comfortable for those long shifts.</strong> <br></span></p> <p><span>Designed by healthcare professionals who understand what you need. Stay comfortable all day!</span></p>'
  },
  'Surgery': {
    title: 'Are they comfortable for surgery?',
    content: '<p><span><strong>Perfect for the OR! Designed for comfort during those marathon procedures.</strong> <br></span></p> <p><span>Lightweight and breathable, won\'t give you a headache during long surgeries. Stay focused on what matters!</span></p>'
  },
  'Style': {
    title: 'Can I look good at work?',
    content: '<p><span><strong>Absolutely! Who says scrubs have to be boring?</strong> <br></span></p> <p><span>Express yourself with our fun designs while staying professional. Your patients will love them!</span></p>'
  },
  'Gift': {
    title: 'Are these good gifts?',
    content: '<p><span><strong>Perfect gift for the healthcare heroes in your life!</strong> <br></span></p> <p><span>Practical, stylish, and thoughtful. Every nurse or doctor needs these!</span></p>'
  }
};

function updateAccordionContent(tagName) {
  const headerElement = document.querySelector('.wdyd-header');
  const contentElement = document.querySelector('.wdyd-content');
  
  if (headerElement && contentElement && tagContent[tagName]) {
    const iconHTML = headerElement.querySelector('.icon').outerHTML;
    headerElement.innerHTML = tagContent[tagName].title + iconHTML;
    contentElement.innerHTML = tagContent[tagName].content;
  }
}

function setActiveTag(clickedTag) {
  const allTags = document.querySelectorAll('.tag');
  allTags.forEach(tag => tag.classList.remove('jactive'));
  clickedTag.classList.add('jactive');
}

const targetHeader = document.querySelector('.wdyd-header');
if (targetHeader) {
  targetHeader.click();
}

document.addEventListener('DOMContentLoaded', function() {
  const tags = document.querySelectorAll('.tag');
  
  tags.forEach(tag => {
    tag.addEventListener('click', function() {
      const tagText = this.textContent.trim();
      setActiveTag(this);
      updateAccordionContent(tagText);

      const accordionHeader = document.querySelector('.wdyd-header');
      if (accordionHeader) {
      }
    });
  });
});

// Open 3rd accordion by default
document.addEventListener('DOMContentLoaded', function() {
  const accordionHeaders = document.querySelectorAll('.woof-accordion-header');
  
  if (accordionHeaders.length >= 3) {
    const thirdHeader = accordionHeaders[2]; // Index 2 = 3rd accordion
    const thirdContent = thirdHeader.nextElementSibling;
    
    // Add active class and show content
    thirdHeader.classList.add('mactive');
    if (thirdContent) {
      thirdContent.style.display = 'block';
    }
  }
});
</script>

<div class="woof-faq">

{% assign description_sections = product.description | split: '<h3>' %}
<div class="woof-accordion">
  {% for section in description_sections %}
    {% unless section == blank %}
      {% assign section_parts = section | split: '</h3>' %}
      {% if section_parts.size > 1 %}
        {% assign header = section_parts[0] | strip %}
        {% assign content = section_parts[1] | strip %}
        
        <button class="woof-accordion-header">{{ header }}<span class="icon"><svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M10 4.24468V5.52128H5.74468V9.94681H4.25532V5.52128H0V4.24468H4.25532V0.0531921H5.74468V4.24468H10Z" fill="black"></path>
        </svg></span></button>
        <div class="woof-accordion-content">
          {{ content }}
        </div>
      {% endif %}
    {% endunless %}
  {% endfor %}
    <button class="woof-accordion-header wdyd-header">Do they work for long shifts?<span class="icon"><svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 4.24468V5.52128H5.74468V9.94681H4.25532V5.52128H0V4.24468H4.25532V0.0531921H5.74468V4.24468H10Z" fill="black"></path></svg></span></button>
        <div class="woof-accordion-content wdyd-content" style="display: none;">
          <p><span><strong>Yes! These are comfortable for those long shifts.</strong> <br></span></p>
<p><span>Designed by healthcare professionals who understand what you need. Stay comfortable all day!</span></p>
        </div>
</div>
</div>
{% comment %}
<div class="loved-by-thousands">
  <h2>Loved by 90,000+ Aussie Nurses & Doctors</h2>
  <div class="video-scroller">
    <div class="video-card">
      <div class="video-wrapper zero1">
      <video  poster="https://cdn.shopify.com/s/files/1/0573/7250/8344/files/Screenshot_2025-07-11_184453.png?v=1752230829">
        <source src="https://cdn.shopify.com/videos/c/o/v/24b7096fe22f4d86b3186d157cb7d8e9.mp4" type="video/mp4" />
        Your browser does not support the video tag.
      </video>
      <div class="play-button"><svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M14.9927 30C12.9221 30 10.9821 29.6079 9.17271 28.8238C7.36333 28.0494 5.77165 26.9748 4.39768 25.6002C3.02371 24.2256 1.94485 22.6331 1.1611 20.8228C0.387034 19.0126 0 17.0716 0 15C0 12.9284 0.387034 10.9874 1.1611 9.17715C1.94485 7.35721 3.02371 5.76476 4.39768 4.39981C5.77165 3.02517 7.36333 1.95063 9.17271 1.17619C10.9821 0.392062 12.9221 0 14.9927 0C17.0634 0 19.0034 0.392062 20.8128 1.17619C22.6318 1.95063 24.2284 3.02517 25.6023 4.39981C26.9763 5.76476 28.0503 7.35721 28.8244 9.17715C29.6081 10.9874 30 12.9284 30 15C30 17.0716 29.6081 19.0126 28.8244 20.8228C28.0503 22.6331 26.9763 24.2256 25.6023 25.6002C24.2284 26.9748 22.6318 28.0494 20.8128 28.8238C19.0034 29.6079 17.0634 30 14.9927 30ZM12.3803 20.9245L20.7547 15.9874C20.9966 15.8325 21.1563 15.6341 21.2337 15.3921C21.3208 15.1404 21.3208 14.8887 21.2337 14.637C21.1563 14.3853 20.9966 14.1917 20.7547 14.0561L12.3803 9.09003C12.119 8.93514 11.8481 8.87222 11.5675 8.90126C11.2966 8.9303 11.0692 9.03195 10.8853 9.2062C10.7015 9.37076 10.6096 9.6031 10.6096 9.90319V20.1113C10.6096 20.4114 10.7015 20.6534 10.8853 20.8374C11.0692 21.0116 11.2917 21.1133 11.553 21.1423C11.8239 21.1617 12.0997 21.0891 12.3803 20.9245Z" fill="white"/>
</svg>
</div>
      </div>
      <span class="ugstext">Scrub cap styling tips</span>
    </div>
    <div class="video-card">
      <div class="video-wrapper zero2">
      <video poster="https://cdn.shopify.com/s/files/1/0573/7250/8344/files/Screenshot_2025-07-11_184520.png?v=1752230830">
        <source src="https://cdn.shopify.com/videos/c/o/v/4026b154ec8c4b3d971a84e87d85fcbd.mp4" type="video/mp4" />
        Your browser does not support the video tag.
      </video>
      <div class="play-button"><svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M14.9927 30C12.9221 30 10.9821 29.6079 9.17271 28.8238C7.36333 28.0494 5.77165 26.9748 4.39768 25.6002C3.02371 24.2256 1.94485 22.6331 1.1611 20.8228C0.387034 19.0126 0 17.0716 0 15C0 12.9284 0.387034 10.9874 1.1611 9.17715C1.94485 7.35721 3.02371 5.76476 4.39768 4.39981C5.77165 3.02517 7.36333 1.95063 9.17271 1.17619C10.9821 0.392062 12.9221 0 14.9927 0C17.0634 0 19.0034 0.392062 20.8128 1.17619C22.6318 1.95063 24.2284 3.02517 25.6023 4.39981C26.9763 5.76476 28.0503 7.35721 28.8244 9.17715C29.6081 10.9874 30 12.9284 30 15C30 17.0716 29.6081 19.0126 28.8244 20.8228C28.0503 22.6331 26.9763 24.2256 25.6023 25.6002C24.2284 26.9748 22.6318 28.0494 20.8128 28.8238C19.0034 29.6079 17.0634 30 14.9927 30ZM12.3803 20.9245L20.7547 15.9874C20.9966 15.8325 21.1563 15.6341 21.2337 15.3921C21.3208 15.1404 21.3208 14.8887 21.2337 14.637C21.1563 14.3853 20.9966 14.1917 20.7547 14.0561L12.3803 9.09003C12.119 8.93514 11.8481 8.87222 11.5675 8.90126C11.2966 8.9303 11.0692 9.03195 10.8853 9.2062C10.7015 9.37076 10.6096 9.6031 10.6096 9.90319V20.1113C10.6096 20.4114 10.7015 20.6534 10.8853 20.8374C11.0692 21.0116 11.2917 21.1133 11.553 21.1423C11.8239 21.1617 12.0997 21.0891 12.3803 20.9245Z" fill="white"/>
</svg>
</div>
      </div>
      <span class="ugstext">How to care for your scrub caps</span>
    </div>
        <div class="video-card">
            <div class="video-wrapper zero3">
      <video poster="https://cdn.shopify.com/s/files/1/0573/7250/8344/files/Screenshot_2025-07-11_184538.png?v=1752230829">
        <source src="https://cdn.shopify.com/videos/c/o/v/a59b89352fe64ea0adf7f7487ce6c014.mp4" type="video/mp4" />
        Your browser does not support the video tag.
      </video>
      <div class="play-button"><svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M14.9927 30C12.9221 30 10.9821 29.6079 9.17271 28.8238C7.36333 28.0494 5.77165 26.9748 4.39768 25.6002C3.02371 24.2256 1.94485 22.6331 1.1611 20.8228C0.387034 19.0126 0 17.0716 0 15C0 12.9284 0.387034 10.9874 1.1611 9.17715C1.94485 7.35721 3.02371 5.76476 4.39768 4.39981C5.77165 3.02517 7.36333 1.95063 9.17271 1.17619C10.9821 0.392062 12.9221 0 14.9927 0C17.0634 0 19.0034 0.392062 20.8128 1.17619C22.6318 1.95063 24.2284 3.02517 25.6023 4.39981C26.9763 5.76476 28.0503 7.35721 28.8244 9.17715C29.6081 10.9874 30 12.9284 30 15C30 17.0716 29.6081 19.0126 28.8244 20.8228C28.0503 22.6331 26.9763 24.2256 25.6023 25.6002C24.2284 26.9748 22.6318 28.0494 20.8128 28.8238C19.0034 29.6079 17.0634 30 14.9927 30ZM12.3803 20.9245L20.7547 15.9874C20.9966 15.8325 21.1563 15.6341 21.2337 15.3921C21.3208 15.1404 21.3208 14.8887 21.2337 14.637C21.1563 14.3853 20.9966 14.1917 20.7547 14.0561L12.3803 9.09003C12.119 8.93514 11.8481 8.87222 11.5675 8.90126C11.2966 8.9303 11.0692 9.03195 10.8853 9.2062C10.7015 9.37076 10.6096 9.6031 10.6096 9.90319V20.1113C10.6096 20.4114 10.7015 20.6534 10.8853 20.8374C11.0692 21.0116 11.2917 21.1133 11.553 21.1423C11.8239 21.1617 12.0997 21.0891 12.3803 20.9245Z" fill="white"/>
</svg>
</div>
      </div>
      <span class="ugstext">Make sure your day off is actually a day off</span>
    </div>
  </div>
</div>
{% endcomment %}
            <div
              class="th_pb_section"
              id="th_product_bundle"
              data-id="{{ product.id }}"></div>
            <div
              id="th_pb_qty_bundle"
              class="th_pb_qty_bundle_cls"
              data-pid="{{ product.id }}"></div>

          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<script>
  $(function() {
    $(".mobile-atc").css({"bottom": "-100px"})
    $(window).scroll(function() {
      $(window).scrollTop() >= 800
        ? $(".mobile-atc").css({"bottom": "0"})
        : $(".mobile-atc").css({"bottom": "-100px"});
    });

    var intervalId2 = window.setInterval(function(){
      for (let i = 0; i < 3; i++) {
        $("html, body").animate({ scrollTop: 0 });
        clearInterval(intervalId2) 
      }
    }, 500);
  });
</script>